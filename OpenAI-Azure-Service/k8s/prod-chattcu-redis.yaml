apiVersion: v1
kind: Service
metadata:
  name: redis-chattcu-svc
  namespace: openai-azure
  labels:
    app: redis-openai-azure
    tier: backend
spec:
  type: ClusterIP
  ports:
    - port: 6379
      targetPort: 6379
      name: http
  selector:
    app: redis-openai-azure
    tier: backend
---
apiVersion: v1
kind: Pod
metadata:
  name: redis-chattcu
  namespace: openai-azure
  labels:
    app: redis-openai-azure
    tier: backend
spec:
  containers:
    - name: redis
      image: redis:latest
      command:
      - redis-server
      args:
      - --requirepass
      - $(REDIS_PASSWORD)
      env:
      - name: REDIS_PASSWORD
        valueFrom:
          secretKeyRef:
            name: chattcu-prod
            key: REDIS_PASSWORD
      resources:
        requests:
          cpu: 50m
          memory: 512Mi
        limits:
          cpu: 1000m
          memory: 1Gi